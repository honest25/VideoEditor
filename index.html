<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StreamCut Pro | Native GPU Editor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body { font-family: 'Inter', sans-serif; background: #000; color: #fff; overflow: hidden; }
        
        /* The Video Container */
        .viewport {
            box-shadow: 0 0 100px rgba(37, 99, 235, 0.2);
            background: #0a0a0a;
            aspect-ratio: 16/9;
            width: 100%;
            max-width: 900px;
        }

        #loading {
            position: fixed; inset: 0; background: #000; z-index: 99;
            display: flex; flex-direction: column; items: center; justify-content: center;
        }

        /* High-speed scrubber */
        input[type=range]::-webkit-slider-thumb {
            appearance: none; width: 2px; height: 120px; background: #ef4444; cursor: col-resize;
        }
    </style>
</head>
<body>

    <div id="loading">
        <div class="w-10 h-10 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"></div>
        <p class="mt-4 text-xs tracking-widest text-blue-500 font-bold uppercase">Waking GPU...</p>
    </div>

    <div id="app" class="hidden flex flex-col h-screen">
        <header class="h-14 px-6 flex items-center justify-between border-b border-white/10 bg-zinc-950">
            <div class="flex items-center gap-2">
                <div class="w-6 h-6 bg-blue-600 rounded"></div>
                <h1 class="font-bold tracking-tighter">STREAMCUT <span class="text-blue-500">NATIVE</span></h1>
            </div>
            <div class="flex gap-3">
                <button onclick="document.getElementById('file-in').click()" class="text-xs font-bold px-4 py-2 bg-white text-black rounded hover:bg-gray-200">IMPORT</button>
                <button onclick="exportScene()" class="text-xs font-bold px-4 py-2 bg-blue-600 rounded hover:bg-blue-700">EXPORT</button>
            </div>
        </header>

        <main class="flex-1 flex flex-col items-center justify-center p-6 bg-zinc-900">
            <div class="viewport rounded-lg overflow-hidden relative">
                <canvas id="view" class="w-full h-full object-contain"></canvas>
                <div id="play-overlay" onclick="togglePlay()" class="absolute inset-0 flex items-center justify-center bg-black/40 opacity-0 hover:opacity-100 cursor-pointer transition">
                    <svg id="play-btn" class="w-20 h-20 fill-white" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                </div>
            </div>
            
            <div class="mt-8 flex gap-6 px-6 py-3 bg-black rounded-full border border-white/10">
                <button onclick="setFx('none')" class="text-[10px] font-bold text-zinc-500 hover:text-white">RAW</button>
                <button onclick="setFx('grayscale(1)')" class="text-[10px] font-bold text-zinc-500 hover:text-white">MONO</button>
                <button onclick="setFx('sepia(1) contrast(1.2)')" class="text-[10px] font-bold text-zinc-500 hover:text-white">VINTAGE</button>
                <button onclick="setFx('hue-rotate(90deg)')" class="text-[10px] font-bold text-zinc-500 hover:text-white">DREAM</button>
            </div>
        </main>

        <footer class="h-48 bg-zinc-950 border-t border-white/10 p-4 relative">
            <div class="flex justify-between text-[10px] font-mono text-zinc-500 mb-2">
                <span id="timer">00:00:00</span>
                <span>TIMELINE V1</span>
            </div>
            
            <div class="relative h-24 bg-zinc-900 rounded border border-white/5 overflow-hidden">
                <div id="clip-ui" class="hidden absolute top-2 bottom-2 left-0 bg-blue-600/20 border-x-2 border-blue-500 flex items-center px-4 text-[10px] font-bold">
                    PROCESSING_VIDEO.MP4
                </div>
                <input type="range" id="scrub" step="0.01" value="0" class="absolute inset-0 z-30 opacity-0 cursor-col-resize">
                <div id="head" class="absolute top-0 bottom-0 w-px bg-red-500 z-20 pointer-events-none"></div>
            </div>
        </footer>

        <input type="file" id="file-in" class="hidden" accept="video/*">
        <video id="v-engine" class="hidden"></video>
    </div>

    <script>
        const state = {
            v: document.getElementById('v-engine'),
            ctx: document.getElementById('view').getContext('2d'),
            cvs: document.getElementById('view'),
            fx: 'none',
            playing: false
        };

        const ui = {
            scrub: document.getElementById('scrub'),
            head: document.getElementById('head'),
            time: document.getElementById('timer'),
            clip: document.getElementById('clip-ui')
        };

        window.onload = () => {
            state.cvs.width = 1920; // Internal High-Res
            state.cvs.height = 1080;
            document.getElementById('loading').remove();
            document.getElementById('app').classList.remove('hidden');
            requestAnimationFrame(draw);
        };

        document.getElementById('file-in').onchange = (e) => {
            const file = e.target.files[0];
            if (!file) return;
            state.v.src = URL.createObjectURL(file);
            state.v.onloadedmetadata = () => {
                ui.scrub.max = state.v.duration;
                ui.clip.classList.remove('hidden');
                ui.clip.style.width = "100%";
            };
        };

        ui.scrub.oninput = () => {
            state.playing = false;
            state.v.pause();
            state.v.currentTime = ui.scrub.value;
            syncUI();
        };

        function draw() {
            if (state.v.readyState >= 2) {
                state.ctx.filter = state.fx;
                state.ctx.drawImage(state.v, 0, 0, 1920, 1080);
                
                // Real-time UI Sync while playing
                if (!state.v.paused) {
                    ui.scrub.value = state.v.currentTime;
                    syncUI();
                }
            }
            requestAnimationFrame(draw);
        }

        function syncUI() {
            const p = (state.v.currentTime / state.v.duration) * 100;
            ui.head.style.left = p + "%";
            const s = Math.floor(state.v.currentTime);
            ui.time.innerText = `00:00:${s < 10 ? '0'+s : s}`;
        }

        function togglePlay() {
            if (state.v.paused) state.v.play(); 
            else state.v.pause();
            document.getElementById('play-btn').style.display = state.v.paused ? 'block' : 'none';
        }

        function setFx(f) { state.fx = f; }

        function exportScene() {
            const stream = state.cvs.captureStream(30);
            const rec = new MediaRecorder(stream, { mimeType: 'video/webm' });
            const chunks = [];
            
            rec.ondataavailable = e => chunks.push(e.data);
            rec.onstop = () => {
                const blob = new Blob(chunks, { type: 'video/webm' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = "streamcut_pro_export.webm";
                a.click();
            };

            state.v.currentTime = 0;
            state.v.play();
            rec.start();
            state.v.onended = () => rec.stop();
            alert("Exporting... The video will play through once to capture.");
        }
    </script>
</body>
</html>
